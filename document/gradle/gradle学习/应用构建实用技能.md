## 版本号的统一管理

- project 的 build.gradle 

  - ```
    ext {
        MIN_SDK_VERSION = 16
        TARGET_SDK_VERSION = 30
    
        APP_COMPAT = 'androidx.appcompat:appcompat:1.2.0'
        MATERIAL = 'com.google.android.material:material:1.2.1'
        CONSTRAINT_LAYOUT = 'androidx.constraintlayout:constraintlayout:2.0.4'
    }
    ```

- module 的 build.gradle 

  - ```
    android {
        defaultConfig {
            applicationId "com.watayouxiang.androiddemo"
            minSdkVersion MIN_SDK_VERSION
            targetSdkVersion TARGET_SDK_VERSION
        }
    }
    
    dependencies {
        implementation APP_COMPAT
        implementation MATERIAL
        implementation CONSTRAINT_LAYOUT
    }
    ```



## 维护敏感信息

- local.properties 添加如下

```
KEY_ALIAS=test_wt666
KEY_PASSWORD=test_wt666
STORE_PASSWORD=test_wt666
```

- app module 的 build.gradle

```
////////////////////////////////////////// 获取 local.properties 参数

Properties properties = new Properties()
properties.load(project.rootProject.file("local.properties").newDataInputStream())

def KEY_ALIAS = properties.getProperty('KEY_ALIAS')
def KEY_PASSWORD = properties.getProperty('KEY_PASSWORD')
def STORE_PASSWORD = properties.getProperty('STORE_PASSWORD')

println("KEY_ALIAS = $KEY_ALIAS, KEY_PASSWORD = $KEY_PASSWORD, STORE_PASSWORD = $STORE_PASSWORD")

////////////////////////////////////////// 获取 local.properties 参数/

android {
    signingConfigs {
        release {
            keyAlias KEY_ALIAS
            keyPassword KEY_PASSWORD
            storeFile file('../wt_apkkey/test_wt666.key')
            storePassword STORE_PASSWORD
        }
    }
}
```



## 依赖库的管理技巧

### 查看工程所有依赖关系

```
// 查看 app module 依赖树
$ ./gradlew :androiddemo:dependencies

// 查看 huawei构建变体 的依赖树
$ ./gradlew :androiddemo:dependencies --configuration huaweiDebugCompileClasspath
```



### 编译期检测依赖的安全性

- 在 app module 的 build.gradle 添加如下

```
// 限制依赖库的使用
// $ ./gradlew :androiddemo:assembleDebug
configurations.all {
    resolutionStrategy.eachDependency { detail ->
        String dependency = detail.requested.toString()
        if (dependency.contains("com.blankj:utilcodex")) {
            throw new RuntimeException("不允许使用 $dependency")
        }
    }
}
```